(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9026],{3327:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},3911:(e,t,s)=>{"use strict";s.d(t,{default:()=>h});var a=s(5155),r=s(2115),l=s(2619),n=s.n(l),i=s(5626),c=s(9630),o=s(8876),d=s(3791),u=s(8708);let x={sm:{track:"w-8 h-4",thumb:"w-3 h-3",translate:"translate-x-4"},md:{track:"w-11 h-6",thumb:"w-5 h-5",translate:"translate-x-5"},lg:{track:"w-14 h-7",thumb:"w-6 h-6",translate:"translate-x-7"}};function m(e){let{checked:t,onChange:s,label:r,description:l,disabled:n=!1,size:i="md"}=e,c=x[i];return(0,a.jsxs)("label",{className:"inline-flex items-start gap-3 ".concat(n?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:[(0,a.jsx)("button",{type:"button",role:"switch","aria-checked":t,"aria-label":r,disabled:n,className:"\n          relative inline-flex flex-shrink-0 rounded-full transition-colors duration-200 ease-in-out\n          focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500\n          ".concat(c.track,"\n          ").concat(t?"bg-green-500":"bg-gray-300","\n          ").concat(n?"":"hover:shadow-md","\n        "),onClick:()=>!n&&s(!t),children:(0,a.jsx)("span",{className:"\n            inline-block rounded-full bg-white shadow-sm transform transition-transform duration-200 ease-in-out\n            ".concat(c.thumb,"\n            ").concat(t?c.translate:"translate-x-0.5","\n            mt-0.5\n          ")})}),(r||l)&&(0,a.jsxs)("div",{className:"flex flex-col",children:[r&&(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:r}),l&&(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-0.5",children:l})]})]})}function g(e){let{percent:t,size:s="md"}=e,r="sm"===s?"h-1.5":"h-2.5";return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex-1 ".concat(r," bg-gray-200 rounded-full overflow-hidden"),children:(0,a.jsx)("div",{className:"".concat(r," ").concat(0===t?"bg-gray-300":t<=25?"bg-red-500":t<=50?"bg-yellow-500":t<=75?"bg-blue-500":"bg-green-500"," rounded-full transition-all duration-300 ease-out"),style:{width:"".concat(Math.max(t,2),"%")}})}),(0,a.jsxs)("span",{className:"text-xs font-mono text-gray-600 tabular-nums w-10 text-right",children:[t,"%"]})]})}var b=s(4193);function h(e){let{id:t}=e,s=(0,b.d)(),[l,x]=(0,r.useState)(null),[h,f]=(0,r.useState)(!0),[y,p]=(0,r.useState)(!1),[v,j]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[k,C]=(0,r.useState)(!1),[S,_]=(0,r.useState)(100),[A,E]=(0,r.useState)("{}"),O=(0,r.useCallback)(async()=>{try{let e=await (0,c.jB)(t);x(e),j(e.title),w(e.description),C(e.enabled),_(e.rollout_percent),E(JSON.stringify(e.payload,null,2))}catch(e){s.error("로딩 실패",e instanceof Error?e.message:"플래그를 불러올 수 없습니다")}finally{f(!1)}},[t]);async function P(){if(l){p(!0);try{let e={};try{e=JSON.parse(A)}catch(e){s.warning("검증 오류","페이로드 JSON이 올바르지 않습니다"),p(!1);return}let a=await (0,c.yZ)(t,l.version,{title:v,description:N,enabled:k,rollout_percent:S,payload_data:e});x(a),s.success("저장 완료","초안이 저장되었습니다")}catch(e){s.error("저장 실패",e instanceof Error?e.message:"저장 실패")}finally{p(!1)}}}async function T(){if(l)try{let e=await (0,c.g8)(t,l.version);x(e),s.success("게시 완료","플래그가 게시되었습니다")}catch(e){s.error("게시 실패",e instanceof Error?e.message:"게시 실패")}}async function z(){if(l)try{let e=await (0,c.tV)(t);x(e),s.success("롤백 완료","이전 상태로 되돌렸습니다")}catch(e){s.error("롤백 실패",e instanceof Error?e.message:"롤백 실패")}}if((0,r.useEffect)(()=>{O()},[O]),h)return(0,a.jsx)("div",{className:"h-64 bg-gray-100 rounded-xl animate-pulse"});if(!l)return(0,a.jsx)("p",{className:"text-gray-500",children:"플래그를 찾을 수 없습니다."});let J="draft"===l.status;return(0,a.jsxs)("div",{className:"max-w-4xl space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(n(),{href:"/admin/ops/flags",className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(i.A,{className:"w-5 h-5"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:l.title}),(0,a.jsx)(o.a,{status:l.status}),(0,a.jsx)("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded ml-2",children:l.flag_key})]}),(0,a.jsx)(d.r,{status:l.status,version:l.version,hasPublishedSnapshot:!!l.published_snapshot,onSaveDraft:P,onPublish:T,onRollback:z,disabled:y}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-5 bg-white border border-gray-200 rounded-xl p-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"이름"}),(0,a.jsx)("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm disabled:bg-gray-50",value:v,onChange:e=>j(e.target.value),disabled:!J})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),(0,a.jsx)("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm disabled:bg-gray-50",rows:3,value:N,onChange:e=>w(e.target.value),disabled:!J})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"활성 상태"}),(0,a.jsx)(m,{checked:k,onChange:e=>J&&C(e),label:k?"활성":"비활성",disabled:!J})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["롤아웃 비율: ",S,"%"]}),(0,a.jsx)("input",{type:"range",min:0,max:100,step:5,className:"w-full",value:S,onChange:e=>_(parseInt(e.target.value)),disabled:!J}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(g,{percent:S,size:"sm"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"페이로드 (JSON)"}),(0,a.jsx)("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm font-mono disabled:bg-gray-50",rows:5,value:A,onChange:e=>E(e.target.value),disabled:!J})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"변경 이력"}),(0,a.jsx)(u.s,{entityType:"ops_feature_flags",entityId:t})]})]})]})}},4193:(e,t,s)=>{"use strict";s.d(t,{OpsToastProvider:()=>x,d:()=>u});var a=s(5155),r=s(2115),l=s(2529),n=s(8874),i=s(2056),c=s(3327),o=s(5229);let d=(0,r.createContext)(null);function u(){let e=(0,r.useContext)(d);if(!e)throw Error("useToast must be used within OpsToastProvider");return e}function x(e){let{children:t}=e,[s,l]=(0,r.useState)([]),n=(0,r.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),i=(0,r.useCallback)(e=>{var t;let s="toast-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,6)),a={...e,id:s},r=null!=(t=e.duration)?t:3e3;l(e=>{let t=[...e,a];return t.length>3?t.slice(-3):t}),r>0&&setTimeout(()=>n(s),r)},[n]),c=(0,r.useCallback)((e,t)=>i({type:"success",title:e,message:t}),[i]),o=(0,r.useCallback)((e,t)=>i({type:"error",title:e,message:t,duration:5e3}),[i]),u=(0,r.useCallback)((e,t)=>i({type:"warning",title:e,message:t}),[i]),x=(0,r.useCallback)((e,t)=>i({type:"info",title:e,message:t}),[i]);return(0,a.jsxs)(d.Provider,{value:{toasts:s,addToast:i,removeToast:n,success:c,error:o,warning:u,info:x},children:[t,(0,a.jsx)(g,{toasts:s,onRemove:n})]})}let m={success:{icon:l.A,iconColor:"text-green-500",border:"border-green-200",bg:"bg-green-50"},error:{icon:n.A,iconColor:"text-red-500",border:"border-red-200",bg:"bg-red-50"},warning:{icon:i.A,iconColor:"text-yellow-500",border:"border-yellow-200",bg:"bg-yellow-50"},info:{icon:c.A,iconColor:"text-blue-500",border:"border-blue-200",bg:"bg-blue-50"}};function g(e){let{toasts:t,onRemove:s}=e;return 0===t.length?null:(0,a.jsx)("div",{className:"fixed top-4 right-4 z-[60] flex flex-col gap-2 max-w-sm w-full pointer-events-none",children:t.map(e=>(0,a.jsx)(b,{toast:e,onRemove:()=>s(e.id)},e.id))})}function b(e){let{toast:t,onRemove:s}=e,r=m[t.type],l=r.icon;return(0,a.jsxs)("div",{className:"\n        pointer-events-auto flex items-start gap-3 p-4 rounded-lg border shadow-lg\n        ".concat(r.bg," ").concat(r.border,"\n        animate-in slide-in-from-right duration-300\n      "),role:"alert",children:[(0,a.jsx)(l,{className:"w-5 h-5 flex-shrink-0 mt-0.5 ".concat(r.iconColor)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t.title}),t.message&&(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-0.5",children:t.message}),t.action&&(0,a.jsx)("button",{className:"text-xs font-medium text-blue-600 hover:text-blue-800 mt-1 underline",onClick:t.action.onClick,children:t.action.label})]}),(0,a.jsx)("button",{className:"flex-shrink-0 p-0.5 text-gray-400 hover:text-gray-600 rounded",onClick:s,"aria-label":"닫기",children:(0,a.jsx)(o.A,{className:"w-4 h-4"})})]})}},5266:(e,t,s)=>{Promise.resolve().then(s.bind(s,3911))},8874:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}},e=>{e.O(0,[2619,5417,7376,8017,3582,8441,1255,7358],()=>e(e.s=5266)),_N_E=e.O()}]);