(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9056],{4323:(e,t,s)=>{Promise.resolve().then(s.bind(s,8664))},8664:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(5155),r=s(2115),n=s(63),l=s(2619),i=s.n(l),c=s(9476),d=s(3341),o=s(6191),x=s(7787),m=s(9027),u=s(7587),p=s(9630),g=s(6738),h=s(8876),b=s(23);function y(e){let{banner:t,onClick:s}=e,{attributes:r,listeners:n,setNodeRef:l,transform:i,transition:d,isDragging:o}=(0,m.gl)({id:t.id}),x={transform:u.Ks.Transform.toString(i),transition:d};return(0,a.jsxs)("div",{ref:l,style:x,className:"flex items-center gap-3 px-4 py-3 bg-white border border-gray-200 rounded-lg ".concat(o?"shadow-lg opacity-75 z-10":""),children:[(0,a.jsx)("button",{className:"flex-shrink-0 p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing rounded",...r,...n,"aria-label":"드래그하여 순서 변경",children:(0,a.jsx)(c.A,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center text-xs font-mono text-gray-500 bg-gray-100 rounded",children:t.priority}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex items-center gap-4 cursor-pointer",onClick:s,children:[(0,a.jsx)("span",{className:"font-medium text-gray-900 truncate",children:t.title}),(0,a.jsx)("span",{className:"text-xs text-gray-500 flex-shrink-0",children:g.et[t.placement]||t.placement}),(0,a.jsx)(h.a,{status:t.status,size:"sm"}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 ml-auto flex-shrink-0",children:["v",t.version]})]})]})}function f(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"h-64 bg-gray-100 rounded-xl animate-pulse"}),children:(0,a.jsx)(j,{})})}function j(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),s=t.get("status")||"",l=t.get("placement")||"",[c,u]=(0,r.useState)([]),[f,j]=(0,r.useState)(!0),[v,N]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1);(0,r.useEffect)(()=>{!async function(){j(!0);try{let e=await (0,p.s1)({status:s||void 0,placement:l||void 0});u(e)}catch(e){}finally{j(!1)}}()},[s,l]);let S=(0,x.FR)((0,x.MS)(x.AN,{activationConstraint:{distance:5}}),(0,x.MS)(x.uN,{coordinateGetter:m.JR})),C=[...c].sort((e,t)=>e.priority-t.priority),_=(0,r.useCallback)(async e=>{let{active:t,over:a}=e;if(!a||t.id===a.id)return;let r=C.findIndex(e=>e.id===t.id),n=C.findIndex(e=>e.id===a.id);if(-1===r||-1===n)return;let i=(0,m.be)(C,r,n).map((e,t)=>({...e,priority:t+1}));u(i),k(!0);try{let e=i.filter((e,t)=>{let s=C.find(t=>t.id===e.id);return s&&s.priority!==t+1}).map(e=>(0,p.cQ)(e.id,e.version,{priority:e.priority}));await Promise.all(e)}catch(e){u(await (0,p.s1)({status:s||void 0,placement:l||void 0}))}finally{k(!1)}},[C,s,l]),R=[{key:"title",label:"제목",sortable:!0,render:e=>(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.title})},{key:"placement",label:"배치",render:e=>(0,a.jsx)("span",{className:"text-sm text-gray-600",children:g.et[e.placement]||e.placement})},{key:"status",label:"상태",sortable:!0,render:e=>(0,a.jsx)(h.a,{status:e.status,size:"sm"})},{key:"priority",label:"우선순위",sortable:!0,className:"text-center",render:e=>(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.priority})},{key:"version",label:"버전",className:"text-center",render:e=>(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["v",e.version]})},{key:"updated_at",label:"수정일",sortable:!0,render:e=>(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.updated_at).toLocaleDateString("ko-KR")})}];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"배너 관리"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm font-medium rounded-lg border transition-colors ".concat(v?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),onClick:()=>N(!v),disabled:w,children:[(0,a.jsx)(d.A,{className:"w-4 h-4"}),v?"순서 조정 완료":"순서 조정"]}),(0,a.jsxs)(i(),{href:"/admin/ops/banners/new",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:[(0,a.jsx)(o.A,{className:"w-4 h-4"}),"새 배너"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("select",{className:"text-sm border border-gray-300 rounded-lg px-3 py-2",value:s,onChange:s=>{let a=new URLSearchParams(t.toString());s.target.value?a.set("status",s.target.value):a.delete("status"),e.push("/admin/ops/banners?".concat(a.toString()))},children:[(0,a.jsx)("option",{value:"",children:"모든 상태"}),(0,a.jsx)("option",{value:"draft",children:"초안"}),(0,a.jsx)("option",{value:"in_review",children:"검수 중"}),(0,a.jsx)("option",{value:"published",children:"게시됨"}),(0,a.jsx)("option",{value:"archived",children:"보관됨"})]}),(0,a.jsxs)("select",{className:"text-sm border border-gray-300 rounded-lg px-3 py-2",value:l,onChange:s=>{let a=new URLSearchParams(t.toString());s.target.value?a.set("placement",s.target.value):a.delete("placement"),e.push("/admin/ops/banners?".concat(a.toString()))},children:[(0,a.jsx)("option",{value:"",children:"모든 배치"}),Object.entries(g.et).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})]}),w&&(0,a.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"w-3 h-3 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),"저장 중..."]})]}),v?(0,a.jsx)(x.Mp,{sensors:S,collisionDetection:x.fp,onDragEnd:_,children:(0,a.jsx)(m.gB,{items:C.map(e=>e.id),strategy:m._G,children:(0,a.jsx)("div",{className:"space-y-2",children:f?Array.from({length:5}).map((e,t)=>(0,a.jsx)("div",{className:"h-14 bg-gray-100 rounded-lg animate-pulse"},t)):0===C.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500 bg-white border border-gray-200 rounded-lg",children:"등록된 배너가 없습니다."}):C.map(t=>(0,a.jsx)(y,{banner:t,onClick:()=>e.push("/admin/ops/banners/".concat(t.id))},t.id))})})}):(0,a.jsx)(b.l,{data:c,columns:R,loading:f,emptyMessage:"등록된 배너가 없습니다.",onRowClick:t=>e.push("/admin/ops/banners/".concat(t.id))})]})}}},e=>{e.O(0,[2619,5417,3511,7376,3423,8441,1255,7358],()=>e(e.s=4323)),_N_E=e.O()}]);