(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9573],{63:(e,t,a)=>{"use strict";var r=a(7260);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},1583:(e,t,a)=>{Promise.resolve().then(a.bind(a,3445))},1786:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},1847:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(2115);let n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:u,...p}=e;return(0,r.createElement)("svg",{ref:t,...s,width:l,height:l,stroke:a,strokeWidth:o?24*Number(i)/Number(l):i,className:n("lucide",d),...p},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),i=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:i,...o}=a;return(0,r.createElement)(l,{ref:s,iconNode:t,className:n("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...o})});return a.displayName="".concat(e),a}},2529:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3327:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},3445:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),n=a(2115),s=a(63),l=a(5626),i=a(3327),o=a(2619),d=a.n(o),c=a(9630),u=a(6738),p=a(5534);function m(){let e=(0,s.useRouter)(),[t,a]=(0,n.useState)(!1),[o,m]=(0,n.useState)(null),[h,g]=(0,n.useState)({title:"",placement:"home_top",image_url:"",link_url:"",link_type:"internal",priority:0,start_at:"",end_at:"",target_audience:"all"});function x(e,t){g(a=>({...a,[e]:t}))}async function b(){if(!h.title.trim())return void m("제목을 입력해주세요");a(!0),m(null);try{let t=await (0,c.Zt)(h);e.push("/admin/ops/banners/".concat(t.id))}catch(e){m(e instanceof Error?e.message:"생성 실패")}finally{a(!1)}}return(0,r.jsxs)("div",{className:"max-w-3xl space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(d(),{href:"/admin/ops/banners",className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(l.A,{className:"w-5 h-5"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"새 배너"})]}),o&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-700",children:o}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 space-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"제목"}),(0,r.jsx)("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"배너 제목을 입력하세요",value:h.title,onChange:e=>x("title",e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"배치 위치"}),(0,r.jsx)("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",value:h.placement,onChange:e=>x("placement",e.target.value),children:Object.entries(u.et).map(e=>{let[t,a]=e;return(0,r.jsx)("option",{value:t,children:a},t)})}),h.placement&&u.au[h.placement]&&(0,r.jsx)("div",{className:"mt-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(i.A,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"font-medium text-blue-900 text-sm",children:["권장 규격: ",u.au[h.placement].width," x ",u.au[h.placement].height,"px (",u.au[h.placement].aspectRatio,")"]}),(0,r.jsx)("div",{className:"text-blue-700 text-xs mt-1",children:u.au[h.placement].description}),u.au[h.placement].safeZone&&(0,r.jsxs)("div",{className:"text-blue-600 text-xs mt-1",children:["안전 영역: ",u.au[h.placement].safeZone]}),(0,r.jsxs)("div",{className:"mt-3 border-2 border-dashed border-blue-300 rounded bg-blue-100/50 flex items-center justify-center text-blue-400 text-xs",style:{aspectRatio:"".concat(u.au[h.placement].width," / ").concat(u.au[h.placement].height),maxHeight:"150px"},children:[u.au[h.placement].width," x ",u.au[h.placement].height]})]})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"배너 이미지"}),h.image_url?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:h.image_url,alt:"Banner preview",className:"w-full max-h-48 object-contain rounded-lg border"}),(0,r.jsx)("button",{className:"absolute top-2 right-2 bg-white text-xs px-2 py-1 rounded shadow",onClick:()=>x("image_url",""),children:"변경"})]}):(0,r.jsx)(p.A,{onUploadComplete:e=>x("image_url",e.public_url),tags:["banner"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"링크 타입"}),(0,r.jsxs)("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",value:h.link_type,onChange:e=>x("link_type",e.target.value),children:[(0,r.jsx)("option",{value:"internal",children:"내부 링크"}),(0,r.jsx)("option",{value:"external",children:"외부 링크"}),(0,r.jsx)("option",{value:"none",children:"없음"})]})]}),"none"!==h.link_type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"링크 URL"}),(0,r.jsx)("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",placeholder:"internal"===h.link_type?"/discover":"https://...",value:h.link_url,onChange:e=>x("link_url",e.target.value)})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"우선순위"}),(0,r.jsx)("input",{type:"number",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",value:h.priority,onChange:e=>x("priority",parseInt(e.target.value)||0)}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"높을수록 먼저 표시"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"대상"}),(0,r.jsxs)("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",value:h.target_audience,onChange:e=>x("target_audience",e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"전체"}),(0,r.jsx)("option",{value:"fans",children:"팬"}),(0,r.jsx)("option",{value:"creators",children:"크리에이터"}),(0,r.jsx)("option",{value:"vip",children:"VIP"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"시작일 (선택)"}),(0,r.jsx)("input",{type:"datetime-local",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",value:h.start_at,onChange:e=>x("start_at",e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"종료일 (선택)"}),(0,r.jsx)("input",{type:"datetime-local",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",value:h.end_at,onChange:e=>x("end_at",e.target.value)})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsx)(d(),{href:"/admin/ops/banners",className:"px-4 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"취소"}),(0,r.jsx)("button",{className:"px-4 py-2 text-sm text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",disabled:t,onClick:b,children:t?"저장 중...":"초안 저장"})]})]})}},5229:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5534:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var r=a(5155),n=a(2115),s=a(5229),l=a(1786),i=a(2529),o=a(8314),d=a(5417),c=a(7376),u=a(9630),p=a(5704);let m={idle:"",validating:"파일 검증 중...",uploading:"업로드 중...",registering:"등록 중...",done:"완료",error:"실패"},h={idle:0,validating:10,uploading:50,registering:85,done:100,error:0};function g(e){var t;let{onUploadComplete:a,accept:g="image/*",maxSizeMb:x=5,tags:b=[]}=e,f=(0,n.useRef)(null),[y,_]=(0,n.useState)(!1),[v,j]=(0,n.useState)("idle"),[w,N]=(0,n.useState)(null),[k,C]=(0,n.useState)(null),[A,E]=(0,n.useState)(null),R=(0,n.useRef)(null),T="idle"!==v&&"done"!==v&&"error"!==v,P=h[v],S=(0,n.useCallback)(()=>{j("idle"),N(null),C(null),E(null),R.current&&(R.current.abort(),R.current=null),f.current&&(f.current.value="")},[]),B=(0,n.useCallback)(async e=>{if(C(null),E(e),j("validating"),e.size>1024*x*1024){C("파일 크기는 ".concat(x,"MB 이하여야 합니다.")),j("error");return}if(!e.type.startsWith("image/")){C("이미지 파일만 업로드 가능합니다."),j("error");return}let t=URL.createObjectURL(e);if(N(t),c.Gc){j("done"),a({id:"demo-asset-".concat(Date.now()),file_name:e.name,storage_path:"ops/".concat(e.name),public_url:t,mime_type:e.type,file_size:e.size,width:null,height:null,tags:b,alt_text:"",uploaded_by:"demo-ops-1",created_at:new Date().toISOString()}),setTimeout(S,1500);return}R.current=new AbortController;try{j("uploading");let r=(0,d.createBrowserClient)(p.env.NEXT_PUBLIC_SUPABASE_URL||"",p.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||""),n=e.name.split(".").pop()||"png",s="banners/".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2),".").concat(n),{error:l}=await r.storage.from("ops-assets").upload(s,e,{contentType:e.type,cacheControl:"3600"});if(l)throw l;let{data:i}=r.storage.from("ops-assets").getPublicUrl(s),o=new Image;o.src=t,await new Promise(e=>o.onload=e),j("registering");let c=await (0,u.FR)({file_name:e.name,storage_path:s,public_url:i.publicUrl,mime_type:e.type,file_size:e.size,width:o.naturalWidth,height:o.naturalHeight,tags:b,alt_text:""});j("done"),a(c),setTimeout(S,1500)}catch(e){var r;if(null==(r=R.current)?void 0:r.signal.aborted)return;C(e instanceof Error?e.message:"업로드 실패"),j("error")}},[x,b,a,S]),Z=(0,n.useCallback)(()=>{A&&B(A)},[A,B]),L=(0,n.useCallback)(()=>{R.current&&R.current.abort(),S()},[S]),U=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?_(!0):"dragleave"===e.type&&_(!1)},[]),G=(0,n.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),_(!1),(null==(t=e.dataTransfer.files)?void 0:t[0])&&B(e.dataTransfer.files[0])},[B]),O=(0,n.useCallback)(e=>{var t;(null==(t=e.target.files)?void 0:t[0])&&B(e.target.files[0])},[B]);return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"relative border-2 border-dashed rounded-lg p-6 text-center transition-colors\n          ".concat(y?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400","\n          ").concat(T?"pointer-events-none":"cursor-pointer","\n        "),onDragEnter:U,onDragLeave:U,onDragOver:U,onDrop:G,onClick:()=>{var e;return!T&&!w&&(null==(e=f.current)?void 0:e.click())},children:[(0,r.jsx)("input",{ref:f,type:"file",accept:g,className:"hidden",onChange:O}),w?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:w,alt:"Preview",className:"max-h-48 mx-auto rounded object-contain"}),"idle"===v&&(0,r.jsx)("button",{className:"absolute top-1 right-1 bg-white rounded-full p-1 shadow hover:bg-gray-100",onClick:e=>{e.stopPropagation(),S()},children:(0,r.jsx)(s.A,{className:"w-4 h-4"})})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)(l.A,{className:"w-8 h-8 text-gray-400"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"이미지를 드래그하거나 클릭하여 업로드"}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["최대 ",x,"MB / PNG, JPG, WebP"]})]}),(T||"done"===v)&&(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[A&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500",children:[(0,r.jsx)("span",{className:"truncate max-w-[200px]",children:A.name}),(0,r.jsx)("span",{children:(t=A.size)<1024?"".concat(t," B"):t<1048576?"".concat((t/1024).toFixed(1)," KB"):"".concat((t/1048576).toFixed(1)," MB")})]}),(0,r.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden mx-auto max-w-xs",children:(0,r.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ease-out ".concat("done"===v?"bg-green-500":"bg-blue-500"),style:{width:"".concat(P,"%")}})}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:["done"===v?(0,r.jsx)(i.A,{className:"w-4 h-4 text-green-500"}):(0,r.jsx)("span",{className:"w-3.5 h-3.5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:m[v]})]}),T&&(0,r.jsx)("button",{className:"text-xs text-gray-500 hover:text-gray-700 underline pointer-events-auto",onClick:e=>{e.stopPropagation(),L()},children:"취소"})]})]}),"error"===v&&(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,r.jsx)("span",{className:"text-red-600 flex-1",children:k}),A&&(0,r.jsxs)("button",{className:"inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 text-xs font-medium",onClick:Z,children:[(0,r.jsx)(o.A,{className:"w-3.5 h-3.5"}),"다시 시도"]}),(0,r.jsx)("button",{className:"text-xs text-gray-500 hover:text-gray-700",onClick:S,children:"닫기"})]})]})}},5626:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6738:(e,t,a)=>{"use strict";a.d(t,{M2:()=>r,au:()=>s,et:()=>n,fn:()=>l});let r={draft:{label:"초안",color:"text-gray-700",bgColor:"bg-gray-100"},in_review:{label:"검수 중",color:"text-yellow-700",bgColor:"bg-yellow-100"},published:{label:"게시됨",color:"text-green-700",bgColor:"bg-green-100"},archived:{label:"보관됨",color:"text-red-700",bgColor:"bg-red-100"}},n={home_top:"홈 상단",home_bottom:"홈 하단",discover_top:"탐색 상단",chat_top:"채팅 상단",profile_banner:"프로필 배너",popup:"팝업"},s={home_top:{width:1200,height:300,label:"홈 상단",description:"메인 히어로 배너 — 풀 너비",aspectRatio:"4:1",safeZone:"좌우 16px 여백"},home_bottom:{width:1200,height:200,label:"홈 하단",description:"보조 프로모션 띠 배너",aspectRatio:"6:1"},discover_top:{width:800,height:400,label:"탐색 상단",description:"탐색 페이지 배너",aspectRatio:"2:1"},chat_top:{width:600,height:150,label:"채팅 상단",description:"채팅 리스트 상단 띠",aspectRatio:"4:1"},profile_banner:{width:800,height:300,label:"프로필 배너",description:"프로필 헤더 영역",aspectRatio:"8:3"},popup:{width:600,height:800,label:"팝업",description:"모달 팝업 (세로)",aspectRatio:"3:4"}},l={viewer:"뷰어",operator:"운영자",publisher:"발행자",admin:"관리자"}},8314:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},9630:(e,t,a)=>{"use strict";a.d(t,{AO:()=>g,E3:()=>N,FR:()=>h,LO:()=>j,WR:()=>v,Xo:()=>_,Zt:()=>f,_v:()=>T,cQ:()=>y,cb:()=>u,g8:()=>E,j$:()=>b,jB:()=>k,jd:()=>p,lA:()=>c,ny:()=>C,qs:()=>m,s1:()=>x,tV:()=>R,wx:()=>P,yZ:()=>A,zU:()=>w});var r=a(5417),n=a(7376),s=a(5704);let l=[{id:"demo-banner-1",title:"신규 아티스트 오픈 기념 이벤트",placement:"home_top",image_url:"https://picsum.photos/seed/banner1/800/400",link_url:"/discover",link_type:"internal",status:"published",priority:10,start_at:null,end_at:null,target_audience:"all",version:2,published_snapshot:null,created_by:"demo-ops-1",updated_by:"demo-ops-1",created_at:"2025-12-01T00:00:00Z",updated_at:"2025-12-10T00:00:00Z"},{id:"demo-banner-2",title:"VIP 전용 특별 혜택",placement:"home_bottom",image_url:"https://picsum.photos/seed/banner2/800/400",link_url:"/subscriptions",link_type:"internal",status:"draft",priority:5,start_at:null,end_at:null,target_audience:"vip",version:1,published_snapshot:null,created_by:"demo-ops-1",updated_by:null,created_at:"2025-12-15T00:00:00Z",updated_at:"2025-12-15T00:00:00Z"}],i=[{id:"demo-flag-1",flag_key:"dark_mode_v2",title:"다크 모드 v2",description:"새로운 다크 모드 디자인 테스트",status:"published",enabled:!0,rollout_percent:50,payload:{variant:"new_palette"},version:3,published_snapshot:null,created_by:"demo-ops-1",updated_by:"demo-ops-1",created_at:"2025-11-01T00:00:00Z",updated_at:"2025-12-05T00:00:00Z"},{id:"demo-flag-2",flag_key:"gift_feature",title:"선물 기능",description:"팬 간 선물 전송 기능",status:"draft",enabled:!1,rollout_percent:0,payload:{},version:1,published_snapshot:null,created_by:"demo-ops-1",updated_by:null,created_at:"2025-12-20T00:00:00Z",updated_at:"2025-12-20T00:00:00Z"}],o=[{id:"demo-audit-1",actor_id:"demo-ops-1",actor_role:"publisher",action:"banner.publish",entity_type:"ops_banners",entity_id:"demo-banner-1",before:{status:"in_review"},after:{status:"published"},metadata:{},created_at:"2025-12-10T14:30:00Z"},{id:"demo-audit-2",actor_id:"demo-ops-1",actor_role:"operator",action:"flag.create",entity_type:"ops_feature_flags",entity_id:"demo-flag-2",before:null,after:{flag_key:"gift_feature",title:"선물 기능"},metadata:{},created_at:"2025-12-20T09:00:00Z"},{id:"demo-audit-3",actor_id:"demo-ops-2",actor_role:"admin",action:"settlement.approve",entity_type:"settlements",entity_id:"settlement-2026-01-waker",before:{status:"pending"},after:{status:"approved",title:"WAKER 2026-01월 정산 승인"},metadata:{artist_name:"WAKER",period:"2026-01"},created_at:"2026-02-05T10:15:00Z"},{id:"demo-audit-4",actor_id:"demo-ops-2",actor_role:"admin",action:"settlement.reject",entity_type:"settlements",entity_id:"settlement-2026-01-moonlight",before:{status:"pending"},after:{status:"rejected",reason:"서류 미비",title:"MOONLIGHT 정산 반려 (서류 미비)"},metadata:{artist_name:"MOONLIGHT",period:"2026-01"},created_at:"2026-02-07T14:22:00Z"},{id:"demo-audit-5",actor_id:"demo-ops-3",actor_role:"moderator",action:"creator.warn",entity_type:"creators",entity_id:"creator-starlight",before:{warning_count:0},after:{warning_count:1,title:"크리에이터 '별빛' 경고 발송"},metadata:{reason:"부적절한 콘텐츠 게시"},created_at:"2026-02-08T16:45:00Z"},{id:"demo-audit-6",actor_id:"demo-ops-3",actor_role:"moderator",action:"creator.suspend",entity_type:"creators",entity_id:"creator-baduser",before:{status:"active"},after:{status:"suspended",title:"크리에이터 '악성유저' 정지 처리"},metadata:{reason:"약관 위반 (중복)",duration_days:30},created_at:"2026-02-10T11:30:00Z"},{id:"demo-audit-7",actor_id:"demo-ops-4",actor_role:"moderator",action:"report.resolve",entity_type:"reports",entity_id:"rpt-002",before:{status:"reviewing"},after:{status:"resolved",title:"신고 #rpt-002 해결 처리",action_taken:"경고 발송"},metadata:{report_type:"harassment"},created_at:"2026-02-11T09:18:00Z"},{id:"demo-audit-8",actor_id:"demo-ops-5",actor_role:"operator",action:"payment.refund",entity_type:"payments",entity_id:"pay-007",before:{status:"completed"},after:{status:"refunded",title:"펀딩 결제 환불 처리 (#pay-007)",amount:9900},metadata:{reason:"고객 요청",refund_method:"original"},created_at:"2026-02-12T13:50:00Z"}];async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(){let e=s.env.NEXT_PUBLIC_SUPABASE_URL||"",t=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";return(0,r.createBrowserClient)(e,t)}(),{data:{session:n}}=await a.auth.getSession();if(!(null==n?void 0:n.access_token))throw Error("인증이 필요합니다. 다시 로그인해주세요.");let l="".concat(s.env.NEXT_PUBLIC_SUPABASE_URL,"/functions/v1/ops-manage"),i=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n.access_token)},body:JSON.stringify({action:e,payload:t})}),o=await i.json();if(!o.success)throw Error(o.error||"요청 실패 (".concat(i.status,")"));return o.data}async function c(){return n.Gc?[]:d("staff.list")}async function u(e,t,a){return d("staff.upsert",{target_user_id:e,role:t,display_name:a})}async function p(e){await d("staff.remove",{target_user_id:e})}async function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?{items:[],total:0}:d("asset.list",e)}async function h(e){return d("asset.upload_complete",e)}async function g(e){await d("asset.delete",{id:e})}async function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?l:d("banner.list",e)}async function b(e){if(n.Gc){let t=l.find(t=>t.id===e);if(!t)throw Error("배너를 찾을 수 없습니다");return t}return d("banner.get",{id:e})}async function f(e){return n.Gc?{...l[0],...e,id:"demo-banner-".concat(Date.now()),status:"draft",version:1}:d("banner.create",{...e})}async function y(e,t,a){if(n.Gc){let r=l.find(t=>t.id===e);if(!r)throw Error("배너를 찾을 수 없습니다");return{...r,...a,version:t+1}}return d("banner.update",{id:e,expected_version:t,...a})}async function _(e,t){return d("banner.submit_review",{id:e,expected_version:t})}async function v(e,t){return d("banner.publish",{id:e,expected_version:t})}async function j(e){return d("banner.rollback",{id:e})}async function w(e,t){return d("banner.archive",{id:e,expected_version:t})}async function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?i:d("flag.list",e)}async function k(e){if(n.Gc){let t=i.find(t=>t.id===e);if(!t)throw Error("플래그를 찾을 수 없습니다");return t}return d("flag.get",{id:e})}async function C(e){return n.Gc?{...i[0],...e,payload:e.payload_data,id:"demo-flag-".concat(Date.now()),status:"draft",version:1}:d("flag.create",{...e})}async function A(e,t,a){if(n.Gc){let r=i.find(t=>t.id===e);if(!r)throw Error("플래그를 찾을 수 없습니다");return{...r,...a,version:t+1}}return d("flag.update",{id:e,expected_version:t,...a})}async function E(e,t){return d("flag.publish",{id:e,expected_version:t})}async function R(e){return d("flag.rollback",{id:e})}async function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?{items:o,total:o.length}:d("audit.list",e)}async function P(){if(n.Gc)return{activeBanners:l.filter(e=>"published"===e.status).length,activeFlags:i.filter(e=>"published"===e.status).length,pendingReview:l.filter(e=>"in_review"===e.status).length,recentChanges:o.slice(0,5)};let[e,t,a]=await Promise.all([x(),N(),T({limit:5})]);return{activeBanners:e.filter(e=>"published"===e.status).length,activeFlags:t.filter(e=>"published"===e.status).length,pendingReview:e.filter(e=>"in_review"===e.status).length,recentChanges:a.items}}}},e=>{e.O(0,[2619,5417,7376,8441,1255,7358],()=>e(e.s=1583)),_N_E=e.O()}]);