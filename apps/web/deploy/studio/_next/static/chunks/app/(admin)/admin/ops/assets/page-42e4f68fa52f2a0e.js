(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[816],{3:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]])},368:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},1786:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},2196:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},5534:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var s=a(5155),r=a(2115),l=a(5229),n=a(1786),i=a(2529),c=a(8314),o=a(5417),d=a(7376),x=a(9630),h=a(5704);let g={idle:"",validating:"파일 검증 중...",uploading:"업로드 중...",registering:"등록 중...",done:"완료",error:"실패"},u={idle:0,validating:10,uploading:50,registering:85,done:100,error:0};function m(e){var t;let{onUploadComplete:a,accept:m="image/*",maxSizeMb:p=5,tags:y=[]}=e,b=(0,r.useRef)(null),[f,j]=(0,r.useState)(!1),[v,N]=(0,r.useState)("idle"),[w,k]=(0,r.useState)(null),[_,C]=(0,r.useState)(null),[A,S]=(0,r.useState)(null),M=(0,r.useRef)(null),z="idle"!==v&&"done"!==v&&"error"!==v,L=u[v],D=(0,r.useCallback)(()=>{N("idle"),k(null),C(null),S(null),M.current&&(M.current.abort(),M.current=null),b.current&&(b.current.value="")},[]),P=(0,r.useCallback)(async e=>{if(C(null),S(e),N("validating"),e.size>1024*p*1024){C("파일 크기는 ".concat(p,"MB 이하여야 합니다.")),N("error");return}if(!e.type.startsWith("image/")){C("이미지 파일만 업로드 가능합니다."),N("error");return}let t=URL.createObjectURL(e);if(k(t),d.Gc){N("done"),a({id:"demo-asset-".concat(Date.now()),file_name:e.name,storage_path:"ops/".concat(e.name),public_url:t,mime_type:e.type,file_size:e.size,width:null,height:null,tags:y,alt_text:"",uploaded_by:"demo-ops-1",created_at:new Date().toISOString()}),setTimeout(D,1500);return}M.current=new AbortController;try{N("uploading");let s=(0,o.createBrowserClient)(h.env.NEXT_PUBLIC_SUPABASE_URL||"",h.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||""),r=e.name.split(".").pop()||"png",l="banners/".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2),".").concat(r),{error:n}=await s.storage.from("ops-assets").upload(l,e,{contentType:e.type,cacheControl:"3600"});if(n)throw n;let{data:i}=s.storage.from("ops-assets").getPublicUrl(l),c=new Image;c.src=t,await new Promise(e=>c.onload=e),N("registering");let d=await (0,x.FR)({file_name:e.name,storage_path:l,public_url:i.publicUrl,mime_type:e.type,file_size:e.size,width:c.naturalWidth,height:c.naturalHeight,tags:y,alt_text:""});N("done"),a(d),setTimeout(D,1500)}catch(e){var s;if(null==(s=M.current)?void 0:s.signal.aborted)return;C(e instanceof Error?e.message:"업로드 실패"),N("error")}},[p,y,a,D]),T=(0,r.useCallback)(()=>{A&&P(A)},[A,P]),E=(0,r.useCallback)(()=>{M.current&&M.current.abort(),D()},[D]),B=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?j(!0):"dragleave"===e.type&&j(!1)},[]),U=(0,r.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),j(!1),(null==(t=e.dataTransfer.files)?void 0:t[0])&&P(e.dataTransfer.files[0])},[P]),R=(0,r.useCallback)(e=>{var t;(null==(t=e.target.files)?void 0:t[0])&&P(e.target.files[0])},[P]);return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"relative border-2 border-dashed rounded-lg p-6 text-center transition-colors\n          ".concat(f?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400","\n          ").concat(z?"pointer-events-none":"cursor-pointer","\n        "),onDragEnter:B,onDragLeave:B,onDragOver:B,onDrop:U,onClick:()=>{var e;return!z&&!w&&(null==(e=b.current)?void 0:e.click())},children:[(0,s.jsx)("input",{ref:b,type:"file",accept:m,className:"hidden",onChange:R}),w?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:w,alt:"Preview",className:"max-h-48 mx-auto rounded object-contain"}),"idle"===v&&(0,s.jsx)("button",{className:"absolute top-1 right-1 bg-white rounded-full p-1 shadow hover:bg-gray-100",onClick:e=>{e.stopPropagation(),D()},children:(0,s.jsx)(l.A,{className:"w-4 h-4"})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(n.A,{className:"w-8 h-8 text-gray-400"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"이미지를 드래그하거나 클릭하여 업로드"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["최대 ",p,"MB / PNG, JPG, WebP"]})]}),(z||"done"===v)&&(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[A&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500",children:[(0,s.jsx)("span",{className:"truncate max-w-[200px]",children:A.name}),(0,s.jsx)("span",{children:(t=A.size)<1024?"".concat(t," B"):t<1048576?"".concat((t/1024).toFixed(1)," KB"):"".concat((t/1048576).toFixed(1)," MB")})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden mx-auto max-w-xs",children:(0,s.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ease-out ".concat("done"===v?"bg-green-500":"bg-blue-500"),style:{width:"".concat(L,"%")}})}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:["done"===v?(0,s.jsx)(i.A,{className:"w-4 h-4 text-green-500"}):(0,s.jsx)("span",{className:"w-3.5 h-3.5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-xs text-gray-600",children:g[v]})]}),z&&(0,s.jsx)("button",{className:"text-xs text-gray-500 hover:text-gray-700 underline pointer-events-auto",onClick:e=>{e.stopPropagation(),E()},children:"취소"})]})]}),"error"===v&&(0,s.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,s.jsx)("span",{className:"text-red-600 flex-1",children:_}),A&&(0,s.jsxs)("button",{className:"inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 text-xs font-medium",onClick:T,children:[(0,s.jsx)(c.A,{className:"w-3.5 h-3.5"}),"다시 시도"]}),(0,s.jsx)("button",{className:"text-xs text-gray-500 hover:text-gray-700",onClick:D,children:"닫기"})]})]})}},5917:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6651:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},7937:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9044:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var s=a(5155),r=a(2115),l=a(5917),n=a(1847);let i=(0,n.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var c=a(1360),o=a(6651),d=a(5229);let x=(0,n.A)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);var h=a(3),g=a(2196),u=a(368),m=a(7937),p=a(9630),y=a(5534),b=a(4784),f=a(7376);function j(e){return e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(1)," KB"):"".concat((e/1048576).toFixed(1)," MB")}function v(e){let{asset:t,onDelete:a}=e,[n,o]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden group",children:[(0,s.jsxs)("div",{className:"aspect-video bg-gray-100 relative",children:[(0,s.jsx)("img",{src:t.public_url,alt:t.alt_text||t.file_name,className:"w-full h-full object-contain"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"})]}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.file_name}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("span",{className:"text-xs text-gray-400",children:j(t.file_size)}),t.width&&t.height&&(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:[t.width,"x",t.height]})]}),t.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.map(e=>(0,s.jsx)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:e},e))}),(0,s.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[(0,s.jsx)("button",{className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",onClick:function(){navigator.clipboard.writeText(t.public_url),o(!0),setTimeout(()=>o(!1),2e3)},title:"URL 복사",children:n?(0,s.jsx)(l.A,{className:"w-3.5 h-3.5 text-green-600"}):(0,s.jsx)(i,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",onClick:a,title:"삭제",children:(0,s.jsx)(c.A,{className:"w-3.5 h-3.5"})})]})]})]})}function N(e){let{asset:t,onDelete:a}=e,[n,o]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"flex items-center gap-4 px-4 py-3 bg-white border-b border-gray-100 last:border-0 hover:bg-gray-50",children:[(0,s.jsx)("div",{className:"w-16 h-12 bg-gray-100 rounded overflow-hidden flex-shrink-0",children:(0,s.jsx)("img",{src:t.public_url,alt:t.alt_text||t.file_name,className:"w-full h-full object-contain"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.file_name}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,s.jsx)("span",{className:"text-xs text-gray-400",children:j(t.file_size)}),t.width&&t.height&&(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:[t.width,"x",t.height]}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:new Date(t.created_at).toLocaleDateString("ko-KR")})]})]}),t.tags.length>0&&(0,s.jsxs)("div",{className:"flex gap-1 flex-shrink-0",children:[t.tags.slice(0,2).map(e=>(0,s.jsx)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:e},e)),t.tags.length>2&&(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["+",t.tags.length-2]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,s.jsx)("button",{className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",onClick:function(){navigator.clipboard.writeText(t.public_url),o(!0),setTimeout(()=>o(!1),2e3)},title:"URL 복사",children:n?(0,s.jsx)(l.A,{className:"w-3.5 h-3.5 text-green-600"}):(0,s.jsx)(i,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",onClick:a,title:"삭제",children:(0,s.jsx)(c.A,{className:"w-3.5 h-3.5"})})]})]})}function w(){let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)(0),[n,i]=(0,r.useState)(!0),[c,j]=(0,r.useState)(null),[w,k]=(0,r.useState)(!1),[_,C]=(0,r.useState)(""),[A,S]=(0,r.useState)(""),[M,z]=(0,r.useState)(null),[L,D]=(0,r.useState)("newest"),[P,T]=(0,r.useState)("grid"),[E,B]=(0,r.useState)(0),U=(0,r.useRef)(null),R=(0,r.useCallback)(e=>{C(e),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{S(e),B(0)},300)},[]);async function O(){i(!0);try{let e=await (0,p.qs)({limit:200});t(e.items),l(e.total)}catch(e){}finally{i(!1)}}(0,r.useEffect)(()=>{O()},[]);let q=(0,r.useMemo)(()=>{let t=new Set;return e.forEach(e=>e.tags.forEach(e=>t.add(e))),Array.from(t).sort()},[e]),F=(0,r.useMemo)(()=>{let t=e;if(A.trim()){let e=A.toLowerCase();t=t.filter(t=>t.file_name.toLowerCase().includes(e))}switch(M&&(t=t.filter(e=>e.tags.includes(M))),L){case"newest":t=[...t].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());break;case"name":t=[...t].sort((e,t)=>e.file_name.localeCompare(t.file_name));break;case"size":t=[...t].sort((e,t)=>t.file_size-e.file_size)}return t},[e,A,M,L]),G=Math.max(1,Math.ceil(F.length/12)),I=F.slice(12*E,(E+1)*12);async function K(){if(c){k(!0);try{await (0,p.AO)(c),t(e=>e.filter(e=>e.id!==c)),l(e=>e-1)}catch(e){}finally{k(!1),j(null)}}}return(0,r.useEffect)(()=>{B(0)},[M,L]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"에셋 라이브러리"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:F.length===a?"".concat(a,"개 파일"):"".concat(F.length," / ").concat(a,"개 파일")})]})}),(0,s.jsx)(y.A,{onUploadComplete:e=>{t(t=>[e,...t]),l(e=>e+1)},maxSizeMb:10}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative flex-1 min-w-[200px] max-w-sm",children:[(0,s.jsx)(o.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",className:"w-full pl-9 pr-8 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"파일명 검색...",value:_,onChange:e=>R(e.target.value)}),_&&(0,s.jsx)("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 p-0.5 text-gray-400 hover:text-gray-600",onClick:()=>{C(""),S(""),B(0)},children:(0,s.jsx)(d.A,{className:"w-3.5 h-3.5"})})]}),(0,s.jsxs)("select",{className:"text-sm border border-gray-300 rounded-lg px-3 py-2",value:L,onChange:e=>D(e.target.value),children:[(0,s.jsx)("option",{value:"newest",children:"최신순"}),(0,s.jsx)("option",{value:"name",children:"이름순"}),(0,s.jsx)("option",{value:"size",children:"크기순"})]}),(0,s.jsxs)("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden",children:[(0,s.jsx)("button",{className:"p-2 ".concat("grid"===P?"bg-gray-100 text-gray-900":"bg-white text-gray-400 hover:text-gray-600"),onClick:()=>T("grid"),title:"그리드 보기",children:(0,s.jsx)(x,{className:"w-4 h-4"})}),(0,s.jsx)("button",{className:"p-2 ".concat("list"===P?"bg-gray-100 text-gray-900":"bg-white text-gray-400 hover:text-gray-600"),onClick:()=>T("list"),title:"리스트 보기",children:(0,s.jsx)(h.A,{className:"w-4 h-4"})})]})]}),q.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[(0,s.jsx)("button",{className:"text-xs px-2.5 py-1 rounded-full border transition-colors ".concat(null===M?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-600 border-gray-300 hover:border-gray-400"),onClick:()=>z(null),children:"전체"}),q.map(e=>(0,s.jsx)("button",{className:"text-xs px-2.5 py-1 rounded-full border transition-colors ".concat(M===e?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-600 border-gray-300 hover:border-gray-400"),onClick:()=>z(M===e?null:e),children:e},e))]}),n?(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Array.from({length:8}).map((e,t)=>(0,s.jsx)("div",{className:"aspect-video bg-gray-100 rounded-lg animate-pulse"},t))}):0===I.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-white border border-gray-200 rounded-lg",children:[(0,s.jsx)(g.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-gray-500",children:A||M?"검색 결과가 없습니다":f.Gc?"데모 모드에서는 업로드된 에셋이 표시되지 않습니다":"에셋을 업로드해주세요"})]}):"grid"===P?(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:I.map(e=>(0,s.jsx)(v,{asset:e,onDelete:()=>j(e.id)},e.id))}):(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:I.map(e=>(0,s.jsx)(N,{asset:e,onDelete:()=>j(e.id)},e.id))}),G>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[F.length,"개 중 ",12*E+1,"-",Math.min((E+1)*12,F.length)]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-30",disabled:0===E,onClick:()=>B(E-1),children:(0,s.jsx)(u.A,{className:"w-4 h-4"})}),(0,s.jsxs)("span",{className:"text-xs text-gray-600 px-2",children:[E+1," / ",G]}),(0,s.jsx)("button",{className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-30",disabled:E>=G-1,onClick:()=>B(E+1),children:(0,s.jsx)(m.A,{className:"w-4 h-4"})})]})]}),(0,s.jsx)(b.C,{open:!!c,onClose:()=>j(null),onConfirm:K,title:"에셋 삭제",description:"이 에셋을 삭제하시겠습니까? 삭제된 파일은 복구할 수 없습니다.",variant:"danger",confirmLabel:"삭제",loading:w})]})}},9619:(e,t,a)=>{Promise.resolve().then(a.bind(a,9044))}},e=>{e.O(0,[5417,7376,8017,8441,1255,7358],()=>e(e.s=9619)),_N_E=e.O()}]);