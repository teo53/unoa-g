"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3423],{23:(e,t,a)=>{a.d(t,{l:()=>d});var r=a(5155),n=a(2115),s=a(2108),o=a(4033),i=a(368),l=a(7937);function d(e){let{data:t,columns:a,keyField:d="id",pageSize:c=10,emptyMessage:u="데이터가 없습니다.",onRowClick:p,loading:m=!1,selectable:h=!1,bulkActions:b=[]}=e,[_,g]=(0,n.useState)(null),[f,y]=(0,n.useState)("asc"),[x,v]=(0,n.useState)(0),[w,N]=(0,n.useState)(new Set),j=(0,n.useRef)(null),k=(0,n.useMemo)(()=>_?[...t].sort((e,t)=>{let a=e[_],r=t[_];return null==a?1:null==r?-1:"string"==typeof a&&"string"==typeof r?"asc"===f?a.localeCompare(r):r.localeCompare(a):"number"==typeof a&&"number"==typeof r?"asc"===f?a-r:r-a:0}):t,[t,_,f]),C=Math.max(1,Math.ceil(k.length/c)),E=k.slice(x*c,(x+1)*c),T=E.map(e=>String(e[d])),S=T.length>0&&T.every(e=>w.has(e)),A=T.some(e=>w.has(e)),Z=(0,n.useCallback)(()=>{N(e=>{let t=new Set(e);return S?T.forEach(e=>t.delete(e)):T.forEach(e=>t.add(e)),t})},[T,S]),R=(0,n.useCallback)((e,t,a)=>{N(r=>{let n=new Set(r);if(a&&null!==j.current){let e=Math.min(j.current,t),a=Math.max(j.current,t);for(let t=e;t<=a;t++){var s;let e=String(null==(s=E[t])?void 0:s[d]);e&&n.add(e)}}else n.has(e)?n.delete(e):n.add(e);return n}),j.current=t},[E,d]),G=(0,n.useCallback)(()=>{N(new Set),j.current=null},[]),B=w.size;return m?(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)("div",{className:"h-12 bg-gray-100 rounded animate-pulse"},t))}):(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[h&&B>0&&(0,r.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 bg-blue-50 border-b border-blue-200",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-700 font-medium",children:[B,"개 선택됨"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[b.map(e=>(0,r.jsx)("button",{className:"px-3 py-1.5 text-xs font-medium rounded-lg ".concat("danger"===e.variant?"bg-red-600 text-white hover:bg-red-700":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),onClick:()=>e.onAction(Array.from(w)),children:e.label},e.label)),(0,r.jsx)("button",{className:"px-3 py-1.5 text-xs text-gray-500 hover:text-gray-700",onClick:G,children:"선택 해제"})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[h&&(0,r.jsx)("th",{className:"px-4 py-3 w-10",children:(0,r.jsx)("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:S,ref:e=>{e&&(e.indeterminate=A&&!S)},onChange:Z})}),a.map(e=>(0,r.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600 ".concat(e.sortable?"cursor-pointer select-none hover:text-gray-900":""," ").concat(e.className||""),onClick:()=>{var t;return e.sortable&&void(_===(t=e.key)?y("asc"===f?"desc":"asc"):(g(t),y("asc")),v(0))},children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[e.label,e.sortable&&_===e.key&&("asc"===f?(0,r.jsx)(s.A,{className:"w-3 h-3"}):(0,r.jsx)(o.A,{className:"w-3 h-3"}))]})},e.key))]})}),(0,r.jsx)("tbody",{children:0===E.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:a.length+ +!!h,className:"px-4 py-8 text-center text-gray-500",children:u})}):E.map((e,t)=>{let n=String(e[d]),s=w.has(n);return(0,r.jsxs)("tr",{className:"border-b border-gray-100 last:border-0 ".concat(s?"bg-blue-50":""," ").concat(p?"cursor-pointer hover:bg-gray-50":""),onClick:()=>null==p?void 0:p(e),children:[h&&(0,r.jsx)("td",{className:"px-4 py-3 w-10",children:(0,r.jsx)("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:s,onChange:e=>{e.stopPropagation(),R(n,t,e.nativeEvent instanceof MouseEvent&&e.nativeEvent.shiftKey)},onClick:e=>e.stopPropagation()})}),a.map(t=>{var a;return(0,r.jsx)("td",{className:"px-4 py-3 ".concat(t.className||""),children:t.render?t.render(e):String(null!=(a=e[t.key])?a:"-")},t.key)})]},n)})})]})}),C>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-gray-50",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[k.length,"개 중 ",x*c+1,"-",Math.min((x+1)*c,k.length)]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30",disabled:0===x,onClick:()=>v(x-1),children:(0,r.jsx)(i.A,{className:"w-4 h-4"})}),(0,r.jsxs)("span",{className:"text-xs text-gray-600 px-2",children:[x+1," / ",C]}),(0,r.jsx)("button",{className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30",disabled:x>=C-1,onClick:()=>v(x+1),children:(0,r.jsx)(l.A,{className:"w-4 h-4"})})]})]})]})}},6738:(e,t,a)=>{a.d(t,{M2:()=>r,au:()=>s,et:()=>n,fn:()=>o});let r={draft:{label:"초안",color:"text-gray-700",bgColor:"bg-gray-100"},in_review:{label:"검수 중",color:"text-yellow-700",bgColor:"bg-yellow-100"},published:{label:"게시됨",color:"text-green-700",bgColor:"bg-green-100"},archived:{label:"보관됨",color:"text-red-700",bgColor:"bg-red-100"}},n={home_top:"홈 상단",home_bottom:"홈 하단",discover_top:"탐색 상단",chat_top:"채팅 상단",profile_banner:"프로필 배너",popup:"팝업"},s={home_top:{width:1200,height:300,label:"홈 상단",description:"메인 히어로 배너 — 풀 너비",aspectRatio:"4:1",safeZone:"좌우 16px 여백"},home_bottom:{width:1200,height:200,label:"홈 하단",description:"보조 프로모션 띠 배너",aspectRatio:"6:1"},discover_top:{width:800,height:400,label:"탐색 상단",description:"탐색 페이지 배너",aspectRatio:"2:1"},chat_top:{width:600,height:150,label:"채팅 상단",description:"채팅 리스트 상단 띠",aspectRatio:"4:1"},profile_banner:{width:800,height:300,label:"프로필 배너",description:"프로필 헤더 영역",aspectRatio:"8:3"},popup:{width:600,height:800,label:"팝업",description:"모달 팝업 (세로)",aspectRatio:"3:4"}},o={viewer:"뷰어",operator:"운영자",publisher:"발행자",admin:"관리자"}},8876:(e,t,a)=>{a.d(t,{a:()=>s});var r=a(5155),n=a(6738);function s(e){let{status:t,size:a="md"}=e,s=n.M2[t]||{label:t,color:"text-gray-700",bgColor:"bg-gray-100"};return(0,r.jsx)("span",{className:"inline-flex items-center rounded-full font-medium ".concat(s.bgColor," ").concat(s.color," ").concat("sm"===a?"text-xs px-2 py-0.5":"text-sm px-2.5 py-1"),children:s.label})}},9630:(e,t,a)=>{a.d(t,{AO:()=>b,E3:()=>j,FR:()=>h,LO:()=>w,WR:()=>v,Xo:()=>x,Zt:()=>f,_v:()=>A,cQ:()=>y,cb:()=>u,g8:()=>T,j$:()=>g,jB:()=>k,jd:()=>p,lA:()=>c,ny:()=>C,qs:()=>m,s1:()=>_,tV:()=>S,wx:()=>Z,yZ:()=>E,zU:()=>N});var r=a(5417),n=a(7376),s=a(5704);let o=[{id:"demo-banner-1",title:"신규 아티스트 오픈 기념 이벤트",placement:"home_top",image_url:"https://picsum.photos/seed/banner1/800/400",link_url:"/discover",link_type:"internal",status:"published",priority:10,start_at:null,end_at:null,target_audience:"all",version:2,published_snapshot:null,created_by:"demo-ops-1",updated_by:"demo-ops-1",created_at:"2025-12-01T00:00:00Z",updated_at:"2025-12-10T00:00:00Z"},{id:"demo-banner-2",title:"VIP 전용 특별 혜택",placement:"home_bottom",image_url:"https://picsum.photos/seed/banner2/800/400",link_url:"/subscriptions",link_type:"internal",status:"draft",priority:5,start_at:null,end_at:null,target_audience:"vip",version:1,published_snapshot:null,created_by:"demo-ops-1",updated_by:null,created_at:"2025-12-15T00:00:00Z",updated_at:"2025-12-15T00:00:00Z"}],i=[{id:"demo-flag-1",flag_key:"dark_mode_v2",title:"다크 모드 v2",description:"새로운 다크 모드 디자인 테스트",status:"published",enabled:!0,rollout_percent:50,payload:{variant:"new_palette"},version:3,published_snapshot:null,created_by:"demo-ops-1",updated_by:"demo-ops-1",created_at:"2025-11-01T00:00:00Z",updated_at:"2025-12-05T00:00:00Z"},{id:"demo-flag-2",flag_key:"gift_feature",title:"선물 기능",description:"팬 간 선물 전송 기능",status:"draft",enabled:!1,rollout_percent:0,payload:{},version:1,published_snapshot:null,created_by:"demo-ops-1",updated_by:null,created_at:"2025-12-20T00:00:00Z",updated_at:"2025-12-20T00:00:00Z"}],l=[{id:"demo-audit-1",actor_id:"demo-ops-1",actor_role:"publisher",action:"banner.publish",entity_type:"ops_banners",entity_id:"demo-banner-1",before:{status:"in_review"},after:{status:"published"},metadata:{},created_at:"2025-12-10T14:30:00Z"},{id:"demo-audit-2",actor_id:"demo-ops-1",actor_role:"operator",action:"flag.create",entity_type:"ops_feature_flags",entity_id:"demo-flag-2",before:null,after:{flag_key:"gift_feature",title:"선물 기능"},metadata:{},created_at:"2025-12-20T09:00:00Z"},{id:"demo-audit-3",actor_id:"demo-ops-2",actor_role:"admin",action:"settlement.approve",entity_type:"settlements",entity_id:"settlement-2026-01-waker",before:{status:"pending"},after:{status:"approved",title:"WAKER 2026-01월 정산 승인"},metadata:{artist_name:"WAKER",period:"2026-01"},created_at:"2026-02-05T10:15:00Z"},{id:"demo-audit-4",actor_id:"demo-ops-2",actor_role:"admin",action:"settlement.reject",entity_type:"settlements",entity_id:"settlement-2026-01-moonlight",before:{status:"pending"},after:{status:"rejected",reason:"서류 미비",title:"MOONLIGHT 정산 반려 (서류 미비)"},metadata:{artist_name:"MOONLIGHT",period:"2026-01"},created_at:"2026-02-07T14:22:00Z"},{id:"demo-audit-5",actor_id:"demo-ops-3",actor_role:"moderator",action:"creator.warn",entity_type:"creators",entity_id:"creator-starlight",before:{warning_count:0},after:{warning_count:1,title:"크리에이터 '별빛' 경고 발송"},metadata:{reason:"부적절한 콘텐츠 게시"},created_at:"2026-02-08T16:45:00Z"},{id:"demo-audit-6",actor_id:"demo-ops-3",actor_role:"moderator",action:"creator.suspend",entity_type:"creators",entity_id:"creator-baduser",before:{status:"active"},after:{status:"suspended",title:"크리에이터 '악성유저' 정지 처리"},metadata:{reason:"약관 위반 (중복)",duration_days:30},created_at:"2026-02-10T11:30:00Z"},{id:"demo-audit-7",actor_id:"demo-ops-4",actor_role:"moderator",action:"report.resolve",entity_type:"reports",entity_id:"rpt-002",before:{status:"reviewing"},after:{status:"resolved",title:"신고 #rpt-002 해결 처리",action_taken:"경고 발송"},metadata:{report_type:"harassment"},created_at:"2026-02-11T09:18:00Z"},{id:"demo-audit-8",actor_id:"demo-ops-5",actor_role:"operator",action:"payment.refund",entity_type:"payments",entity_id:"pay-007",before:{status:"completed"},after:{status:"refunded",title:"펀딩 결제 환불 처리 (#pay-007)",amount:9900},metadata:{reason:"고객 요청",refund_method:"original"},created_at:"2026-02-12T13:50:00Z"}];async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(){let e=s.env.NEXT_PUBLIC_SUPABASE_URL||"",t=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";return(0,r.createBrowserClient)(e,t)}(),{data:{session:n}}=await a.auth.getSession();if(!(null==n?void 0:n.access_token))throw Error("인증이 필요합니다. 다시 로그인해주세요.");let o="".concat(s.env.NEXT_PUBLIC_SUPABASE_URL,"/functions/v1/ops-manage"),i=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n.access_token)},body:JSON.stringify({action:e,payload:t})}),l=await i.json();if(!l.success)throw Error(l.error||"요청 실패 (".concat(i.status,")"));return l.data}async function c(){return n.Gc?[]:d("staff.list")}async function u(e,t,a){return d("staff.upsert",{target_user_id:e,role:t,display_name:a})}async function p(e){await d("staff.remove",{target_user_id:e})}async function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?{items:[],total:0}:d("asset.list",e)}async function h(e){return d("asset.upload_complete",e)}async function b(e){await d("asset.delete",{id:e})}async function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?o:d("banner.list",e)}async function g(e){if(n.Gc){let t=o.find(t=>t.id===e);if(!t)throw Error("배너를 찾을 수 없습니다");return t}return d("banner.get",{id:e})}async function f(e){return n.Gc?{...o[0],...e,id:"demo-banner-".concat(Date.now()),status:"draft",version:1}:d("banner.create",{...e})}async function y(e,t,a){if(n.Gc){let r=o.find(t=>t.id===e);if(!r)throw Error("배너를 찾을 수 없습니다");return{...r,...a,version:t+1}}return d("banner.update",{id:e,expected_version:t,...a})}async function x(e,t){return d("banner.submit_review",{id:e,expected_version:t})}async function v(e,t){return d("banner.publish",{id:e,expected_version:t})}async function w(e){return d("banner.rollback",{id:e})}async function N(e,t){return d("banner.archive",{id:e,expected_version:t})}async function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?i:d("flag.list",e)}async function k(e){if(n.Gc){let t=i.find(t=>t.id===e);if(!t)throw Error("플래그를 찾을 수 없습니다");return t}return d("flag.get",{id:e})}async function C(e){return n.Gc?{...i[0],...e,payload:e.payload_data,id:"demo-flag-".concat(Date.now()),status:"draft",version:1}:d("flag.create",{...e})}async function E(e,t,a){if(n.Gc){let r=i.find(t=>t.id===e);if(!r)throw Error("플래그를 찾을 수 없습니다");return{...r,...a,version:t+1}}return d("flag.update",{id:e,expected_version:t,...a})}async function T(e,t){return d("flag.publish",{id:e,expected_version:t})}async function S(e){return d("flag.rollback",{id:e})}async function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.Gc?{items:l,total:l.length}:d("audit.list",e)}async function Z(){if(n.Gc)return{activeBanners:o.filter(e=>"published"===e.status).length,activeFlags:i.filter(e=>"published"===e.status).length,pendingReview:o.filter(e=>"in_review"===e.status).length,recentChanges:l.slice(0,5)};let[e,t,a]=await Promise.all([_(),j(),A({limit:5})]);return{activeBanners:e.filter(e=>"published"===e.status).length,activeFlags:t.filter(e=>"published"===e.status).length,pendingReview:e.filter(e=>"in_review"===e.status).length,recentChanges:a.items}}}}]);