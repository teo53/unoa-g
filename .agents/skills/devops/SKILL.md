---
name: DevOps
description: 서버 상태, DB 연결, 백그라운드 구동 스크립트 모니터링을 전담하여 이상 여부를 지속 체크하고 알림을 보냅니다.
---

# 인프라 모니터링 및 상태 검사 스킬 (DevOps)

이 스킬은 프로젝트 내에서 돌아가고 있는 백그라운드 프로세스, 데이터베이스, 서버 등의 생존 여부(Health Check)를 판단하고 위기 상황을 사용자에게 알리는 워크플로우를 정의합니다.

## 🎯 주요 목적
- 주요 백그라운드 프로세스(예: `sync_dart_financials.py` 등)의 크래시 방지 및 재실행 모니터링
- 에러 로그 탐지 및 개발자 알림(`notify_user` 또는 외부 슬랙/이메일 연동) 자동화
- 주기적 Health Check를 통한 잠재적 서비스 마비 요인 사전 극복

## 🚀 실행 지침

1. **상태 검사 주기 및 대상**
   - 사용자가 '인프라 점검' 혹은 '현재 도는 데몬 확인해봐'라고 요청하면 이 스킬이 주도합니다.
   - `ps -aux` 나 `pgrep`, 윈도우의 경우 `tasklist` 등을 활용하여 대상 백그라운드 프로세스의 PID 및 구동 여부를 체크합니다. (예: `python sync_dart_financials.py`가 돌고 있는지 확인)
   - DB 통신이 올바른지 확인하기 위해 지정된 테스트 쿼리 테이블(`ops_heartbeat` 등)에 Ping 테스트를 진행하는 스크립트를 단발성으로 돌려 검사합니다.

2. **로그 추적 (Log Tail & Grep)**
   - 백그라운드 프로세스가 남기는 로그 파일(예: `logs/error.log` 혹은 `nohup.out`)의 최근 N줄을 주기적으로 읽어, `ERROR`, `FATAL`, `EXCEPTION` 키워드가 존재하는지 스캐닝합니다.
   - 분석 중 예외 흔적이 발견되면 에러 스택을 갈무리하여 사용자에게 즉각 보고용 메시지를 완성합니다.

3. **자동화 복구(Recovery) 및 알림**
   - 프로세스가 죽었다고 판단된 경우, 재시작 런북(Runbook) 스크립트가 있다면 해당 스크립트를 트리거하여 자동 복구를 시도합니다.
   - 만약 복구를 시도할 수 없거나 복구에 실패한 인시던트(Incident)급 장애라면, `notify_user` 도구를 강력히 활용하여 "긴급: 백그라운드 수집 프로세스 종료됨"이라는 메시지와 함께 원인 단서를 사용자에게 제시합니다.

4. **산출물**
   - 점검 후 상태 보고서는 `task Summary` 단계나 `notify_user` 메시지에 간결한 불릿 포인트(상태: 정상/주의/위험 등)로 정리하여 사용자 가시성을 높입니다.
